{% extends "../layouts/base.html" %}

{% block title %} 商品 {% endblock %} 

<!-- Specific Page CSS goes HERE  -->
{% block stylesheets %}
    <link rel="stylesheet" href="/static/shop/css/plugins/ekko-lightbox.css">
    <link rel="stylesheet" href="/static/shop/css/plugins/lightbox.min.css">
{% endblock stylesheets %}

{% block content %}

    <!-- [ Main Content ] start -->
    <div class="pcoded-main-container">
        <div class="pcoded-content">
            <!-- [ breadcrumb ] start -->
            <!-- <div class="page-header">
                <div class="page-block">
                    <div class="row align-items-center">
                        <div class="col-md-12">
                            <div class="page-header-title">
                                <h5 class="m-b-10">Dashboard Analytics</h5>
                            </div>
                            <ul class="breadcrumb">
                                <li class="breadcrumb-item"><a href="index.html"><i class="feather icon-home"></i></a></li>
                                <li class="breadcrumb-item"><a href="#!">Dashboard Analytics</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div> -->
            <!-- [ breadcrumb ] end -->
            <!-- [ Main Content ] start -->
            <div class="row">
                <!-- [ Gallery-description ] start -->
				<div class="col-sm-12 gallery-masonry">
                    <div class="card-columns">
                        {% if products %}
                            {% for product in products %}
                                <div class="card" id="product-card-{{ forloop.counter }}">
                                    <div id="carouselControl{{forloop.counter0}}" class="carousel slide" data-ride="false" data-interval="false">
                                        {% if product.image_set and product.image_set.count > 1 %}
                                            <ol class="carousel-indicators">
                                                {% for image in product.image_set.all %}
                                                    <li data-target="#carouselControl{{forloop.parentloop.counter0}}" date-slide-to="{{forloop.counter0}}" class="active"></li>
                                                {% endfor %}
                                            </ol>
                                        {% endif %}
                                        <div class="carousel-inner">
                                            {% if not product.image_set or product.image_set.count == 0 %}
                                                <div class="carousel-item active">
                                                    <img class="d-block w-100" src="https://s3.us-west-1.wasabisys.com/tofubtq-shop-images/image-icon.png" alt="No image">
                                                </div>
                                            {% elif product.image_set.count == 1 %}
                                                <div class="carousel-item active">
                                                    <img class="d-block w-100" src={{ product.image_set.first.url }} alt="Product image">
                                                </div>
                                            {% else %}
                                                {% for image in product.image_set.all %}
                                                    {% if forloop.counter0 == 0 %}
                                                        <div class="carousel-item active">
                                                            <img class="d-block w-100" src={{image.url}} alt="First slide">
                                                        </div>
                                                    {% else %}
                                                        <div class="carousel-item">
                                                            <img class="d-block w-100" src={{image.url}} alt="First slide">
                                                        </div>
                                                    {% endif %}
                                                {% endfor %}
                                                <a class="carousel-control-prev" href="#carouselControl{{forloop.counter0}}" role="button" data-slide="prev">
                                                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                                    <span class="sr-only">Previous</span>
                                                </a>
                                                <a class="carousel-control-next" href="#carouselControl{{forloop.counter0}}" role="button" data-slide="next">
                                                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                                    <span class="sr-only">Next</span>
                                                </a>
                                            {% endif %}
                                        </div>
                                    </div>
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between">
                                            <div>
                                                <h5 class="job-card-desc">{{ product.brand }}</h5>
                                                <p>{{ product.name }}</p>
                                                <div class="job-meta-data mb-1">NT<i class="fas fa-dollar-sign"></i>
                                                    {% if product.resell_price_nt < product.reference_price_nt %}
                                                        <span class="strikethrough border-color-red">{{ product.reference_price_nt }}</span>
                                                        <i class="fas fa-arrow-right"></i>
                                                    {% endif %}
                                                    {{ product.resell_price_nt }}
                                                </div>
                                            </div>
                                            <div>
                                                <button type="button" class="btn btn-outline-dark font-weight-bolder" onclick="getTags('{{product.token}}')">加入購物車</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            {% endfor %}
                        {% endif %}
                    </div>
                </div>
                <div id="modal-view-product" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="{{ selected_product.token }}" aria-hidden="true">
                    <div class="modal-dialog modal-dialog-centered" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="title-{{ selected_product.token }}">{{ selected_product.name }}</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                            </div>
                            <div id="modal-container">
                                
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- [ Main Content ] end -->
        </div>
    </div>
    <!-- [ Main Content ] end -->

{% endblock content %}

<!-- Specific Page JS goes HERE  -->
{% block javascripts %}

    <!-- ekko-lightbox Js -->
	<script src="/static/shop/js/plugins/ekko-lightbox.min.js"></script>
	<script src="/static/shop/js/plugins/lightbox.min.js"></script>
	<script src="/static/shop/js/pages/ac-lightbox.js"></script>

{% endblock javascripts %}
